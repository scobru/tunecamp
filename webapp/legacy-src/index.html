<!DOCTYPE html>
<html lang="en" data-theme="tunecamp">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TuneCamp Server</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
  <div id="app" class="flex h-screen bg-black text-white font-sans overflow-hidden">
    <!-- Desktop Sidebar (Hidden on mobile) -->
    <aside class="w-64 bg-black flex-col gap-2 p-2 hidden lg:flex shrink-0">
      <!-- Brand -->
      <div class="flex items-center gap-3 px-4 py-4 mb-2">
        <img src="tunecamp.svg" alt="TuneCamp" class="w-8 h-8 drop-shadow-[0_0_8px_var(--color-primary)]">
        <span class="text-xl font-bold tracking-tight text-white">TuneCamp</span>
      </div>

      <!-- Main Nav -->
      <ul class="menu bg-base-200/50 rounded-box w-full gap-1 p-2 font-medium">
        <li><a href="#/" class="nav-link active" data-route="home"><span class="text-xl mr-2">ğŸ </span> Home</a></li>
        <li><a href="#/search" class="nav-link" data-route="search"><span class="text-xl mr-2">ğŸ”</span> Search</a></li>
        <li><a href="#/network" class="nav-link" data-route="network"><span class="text-xl mr-2">ğŸŒ</span> Network</a>
        </li>
      </ul>

      <!-- Library Nav -->
      <div class="px-4 py-2 mt-2 opacity-50 text-xs font-bold uppercase tracking-wider">Your Library</div>
      <ul class="menu bg-base-200/50 rounded-box w-full gap-1 p-2 font-medium flex-1 overflow-y-auto">
        <li><a href="#/albums" class="nav-link" data-route="albums"><span class="text-lg mr-2">ğŸ’¿</span> Albums</a></li>
        <li><a href="#/artists" class="nav-link" data-route="artists"><span class="text-lg mr-2">ğŸ‘¤</span> Artists</a>
        </li>
        <li><a href="#/tracks" class="nav-link" data-route="tracks"><span class="text-lg mr-2">ğŸµ</span> Tracks</a></li>
        <li><a href="#/stats" class="nav-link" data-route="stats"><span class="text-lg mr-2">ğŸ“Š</span> Stats</a></li>
        <li><a href="#/browser" class="nav-link" data-route="browser"><span class="text-lg mr-2">ğŸ“‚</span> Files</a>
        </li>
        <div class="divider my-1"></div>
        <li><a href="#/support" class="nav-link" data-route="support"><span class="text-lg mr-2">â¤ï¸</span> Support</a>
        </li>
      </ul>

      <!-- User / Admin Footer -->
      <div class="p-2 border-t border-white/5 mt-auto">
        <div class="flex flex-col gap-2">
          <button class="btn btn-sm btn-ghost justify-start" id="user-login-btn">
            ğŸ‘¤ <span id="user-name-display">Login</span>
          </button>
          <button class="btn btn-sm btn-ghost justify-start text-xs opacity-50 hover:opacity-100" id="admin-btn">
            ğŸ”§ Admin Panel
          </button>
        </div>
      </div>
    </aside>

    <!-- Mobile Nav Header (Visible only on mobile) -->
    <div
      class="lg:hidden fixed top-0 left-0 right-0 h-16 bg-black/90 backdrop-blur-md z-50 flex items-center justify-between px-4 border-b border-white/5">
      <div class="flex items-center gap-2">
        <img src="tunecamp.svg" alt="TuneCamp" class="w-8 h-8">
        <span class="font-bold">TuneCamp</span>
      </div>
      <button class="btn btn-square btn-ghost" onclick="document.getElementById('mobile-drawer').checked = true">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16" />
        </svg>
      </button>
    </div>

    <!-- Mobile Drawer Content -->
    <div class="drawer lg:hidden z-50">
      <input id="mobile-drawer" type="checkbox" class="drawer-toggle" />
      <div class="drawer-content flex flex-col">
        <!-- Page content here -->
      </div>
      <div class="drawer-side">
        <label htmlFor="mobile-drawer" aria-label="close sidebar" class="drawer-overlay"></label>
        <ul class="menu bg-base-200 text-base-content min-h-full w-80 p-4">
          <!-- Mobile Menu Items (Clone of desktop roughly) -->
          <li class="mb-4 text-2xl font-bold px-4">TuneCamp</li>
          <li><a href="#/" class="nav-link">Home</a></li>
          <li><a href="#/search" class="nav-link">Search</a></li>
          <li><a href="#/albums" class="nav-link">Albums</a></li>
          <li><a href="#/artists" class="nav-link">Artists</a></li>
          <li><a href="#/tracks" class="nav-link">Tracks</a></li>
          <div class="divider"></div>
          <li><a href="#/admin" class="nav-link">Admin</a></li>
        </ul>
      </div>
    </div>

    <!-- Main Content Area -->
    <main
      class="flex-1 bg-base-100 relative overflow-hidden flex flex-col h-full rounded-tl-2xl border-t border-l border-white/5 lg:mr-2 lg:mt-2 lg:mb-24 shadow-2xl">
      <div class="flex-1 overflow-y-auto pb-32 scroll-smooth" id="scroll-container">
        <div id="main-content" class="min-h-full">
          <!-- Dynamic Content -->
        </div>
      </div>

      <!-- Top bar gradient / sticky header could go here -->
    </main>


    <!-- Audio Player -->
    <div
      class="player fixed bottom-0 left-0 right-0 bg-base-200/90 backdrop-blur-xl border-t border-white/5 p-4 lg:p-6 flex flex-col lg:flex-row items-center gap-4 lg:gap-12 z-50 shadow-2xl"
      id="player">
      <div class="player-track flex items-center gap-4 min-w-[280px] w-full lg:w-auto">
        <div class="player-cover w-14 h-14 rounded-lg bg-base-300 flex items-center justify-center shrink-0 shadow-lg"
          id="player-cover">
          <span class="player-cover-icon text-2xl">ğŸµ</span>
        </div>
        <div class="player-info overflow-hidden">
          <div class="player-title font-bold text-white truncate" id="player-title">No track playing</div>
          <div class="player-artist text-sm opacity-60 truncate" id="player-artist"></div>
        </div>
      </div>

      <div class="player-controls flex items-center gap-4">
        <button class="btn btn-circle btn-ghost btn-sm text-xl" id="prev-btn">â®</button>
        <button
          class="btn btn-circle btn-primary bg-white text-black hover:bg-white/90 hover:scale-105 transition-all text-xl shadow-[0_0_20px_rgba(255,255,255,0.2)]"
          id="play-btn">â–¶</button>
        <button class="btn btn-circle btn-ghost btn-sm text-xl" id="next-btn">â­</button>
        <div class="flex items-center ml-2 border-l border-white/10 pl-4 gap-1">
          <button class="btn btn-ghost btn-xs btn-circle" id="lyrics-btn" title="Lyrics">ğŸ¤</button>
          <button class="btn btn-ghost btn-xs btn-circle" id="queue-btn" title="Queue">â˜°</button>
        </div>
      </div>

      <div class="player-progress flex-1 flex flex-col justify-center h-12 w-full lg:w-auto relative group">
        <!-- Canvas for Waveform -->
        <canvas id="waveform-canvas"
          class="w-full h-full cursor-pointer opacity-80 hover:opacity-100 transition-opacity" height="60"></canvas>

        <!-- Fallback / simple progress bar (hidden if waveform exists) -->
        <div id="simple-progress-container" class="absolute inset-0 flex items-center gap-3 w-full"
          style="display: none;">
          <span class="time text-xs opacity-50 font-mono min-w-[40px]" id="current-time">0:00</span>
          <input type="range" class="range range-xs range-primary flex-1" id="progress-bar" min="0" max="100" value="0">
          <span class="time text-xs opacity-50 font-mono min-w-[40px]" id="total-time">0:00</span>
        </div>

        <!-- Time hover tooltip -->
        <div id="hover-time"
          class="absolute top-[-25px] left-0 bg-black/80 text-white text-[10px] px-2 py-0.5 rounded opacity-0 pointer-events-none transition-opacity">
          0:00</div>
      </div>

      <div class="player-volume hidden lg:flex items-center gap-3">
        <span class="opacity-50 text-sm">ğŸ”Š</span>
        <input type="range" class="range range-xs w-24" id="volume-bar" min="0" max="100" value="80">
      </div>
      <audio id="audio-element" preload="metadata"></audio>
    </div>

    <!-- Lyrics Panel -->
    <div class="lyrics-panel" id="lyrics-panel" style="display: none;">
      <div class="lyrics-header">
        <h3>Lyrics</h3>
        <button class="close-btn"
          onclick="document.getElementById('lyrics-panel').style.display='none'">&times;</button>
      </div>
      <div class="lyrics-content" id="lyrics-content">
        Loading...
      </div>
    </div>

    <!-- Queue Panel -->
    <div class="lyrics-panel queue-panel" id="queue-panel" style="display: none; right: 350px;">
      <div class="lyrics-header">
        <h3>Queue</h3>
        <button class="close-btn" onclick="document.getElementById('queue-panel').style.display='none'">&times;</button>
      </div>
      <div class="lyrics-content" id="queue-content">
        <!-- populated by js -->
      </div>
    </div>
  </div>

  <!-- Login Modal -->
  <dialog id="login-modal" class="modal">
    <div class="modal-box bg-base-100 border border-white/5">
      <div class="flex items-center justify-between mb-6">
        <h2 id="modal-title" class="text-2xl font-bold">Admin Login</h2>
        <form method="dialog">
          <button class="btn btn-sm btn-circle btn-ghost" id="modal-close">âœ•</button>
        </form>
      </div>
      <div id="modal-body">
        <form id="login-form" class="space-y-4">
          <div class="form-control">
            <label class="label" for="username">
              <span class="label-text">Username</span>
            </label>
            <input type="text" id="username" placeholder="admin" class="input input-bordered w-full" required
              autocomplete="username">
          </div>
          <div class="form-control">
            <label class="label" for="password">
              <span class="label-text">Password</span>
            </label>
            <input type="password" id="password" placeholder="Enter admin password" class="input input-bordered w-full"
              required autocomplete="current-password">
          </div>
          <button type="submit" class="btn btn-primary w-full accent-gradient border-none mt-4">Login</button>
        </form>
        <div id="login-error" class="text-error text-sm mt-2"></div>
      </div>
    </div>
  </dialog>

  <!-- User Auth Modal -->
  <dialog id="user-auth-modal" class="modal">
    <div class="modal-box bg-base-100 border border-white/5 max-w-sm">
      <div class="flex items-center justify-between mb-6">
        <h2 id="user-modal-title" class="text-2xl font-bold">Login</h2>
        <form method="dialog">
          <button class="btn btn-sm btn-circle btn-ghost" id="user-modal-close">âœ•</button>
        </form>
      </div>

      <div id="user-modal-body" class="space-y-4">
        <!-- Tab buttons -->
        <div class="tabs tabs-box bg-base-200 p-1 mb-4">
          <button class="tab tab-active flex-1" id="tab-login">Login</button>
          <button class="tab flex-1" id="tab-register">Register</button>
        </div>

        <!-- Login Form -->
        <form id="user-login-form" class="space-y-4">
          <div class="form-control">
            <label class="label" for="login-username">
              <span class="label-text">Username</span>
            </label>
            <input type="text" id="login-username" placeholder="your_username" class="input input-bordered w-full"
              required autocomplete="username">
          </div>
          <div class="form-control">
            <label class="label" for="login-password">
              <span class="label-text">Password</span>
            </label>
            <input type="password" id="login-password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢" class="input input-bordered w-full" required
              autocomplete="current-password">
          </div>
          <button type="submit" class="btn btn-primary w-full accent-gradient border-none mt-2">Login</button>
        </form>

        <!-- Register Form (hidden by default) -->
        <form id="user-register-form" class="space-y-4" style="display: none;">
          <div class="form-control">
            <label class="label" for="reg-username">
              <span class="label-text">Choose a username</span>
            </label>
            <input type="text" id="reg-username" placeholder="your_username" class="input input-bordered w-full"
              required autocomplete="username">
            <label class="label">
              <span class="label-text-alt opacity-70">At least 3 characters</span>
            </label>
          </div>
          <div class="form-control">
            <label class="label" for="reg-password">
              <span class="label-text">Password</span>
            </label>
            <input type="password" id="reg-password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢" class="input input-bordered w-full" required
              autocomplete="new-password">
            <label class="label">
              <span class="label-text-alt opacity-70">At least 6 characters</span>
            </label>
          </div>
          <div class="form-control">
            <label class="label" for="reg-password-confirm">
              <span class="label-text">Confirm Password</span>
            </label>
            <input type="password" id="reg-password-confirm" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢" class="input input-bordered w-full"
              required autocomplete="new-password">
          </div>
          <button type="submit" class="btn btn-primary w-full accent-gradient border-none mt-2">Create Account</button>
        </form>

        <div id="user-auth-error" class="text-error text-sm mt-2"></div>
      </div>
    </div>
  </dialog>

  <dialog id="add-to-playlist-modal" class="modal">
    <div class="modal-box bg-base-100 border border-white/5 max-w-sm">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold">Add to Playlist</h2>
        <form method="dialog">
          <button class="btn btn-sm btn-circle btn-ghost" id="playlist-modal-close">âœ•</button>
        </form>
      </div>
      <div>
        <div id="playlist-selection" class="flex flex-col gap-2">
          <!-- Populated dynamically -->
        </div>
        <button class="btn btn-outline btn-primary w-full mt-6" id="create-new-playlist-btn">
          + Create New Playlist
        </button>
      </div>
    </div>
  </dialog>

  <!-- Unlock Code Modal -->
  <dialog id="unlock-modal" class="modal">
    <div class="modal-box bg-base-100 border border-white/5 max-w-sm">
      <div class="flex items-center justify-between mb-4">
        <h2 class="text-2xl font-bold">Unlock Download</h2>
        <form method="dialog">
          <button class="btn btn-sm btn-circle btn-ghost" id="unlock-modal-close">âœ•</button>
        </form>
      </div>
      <div>
        <p class="text-sm opacity-70 mb-6">Enter your unlock code to download this release.</p>
        <form id="unlock-form" class="space-y-4">
          <div class="form-control">
            <label class="label" for="unlock-code-input">
              <span class="label-text">Unlock Code</span>
            </label>
            <input type="text" id="unlock-code-input" placeholder="XXXX-XXXX"
              class="input input-bordered w-full font-mono uppercase" required>
          </div>
          <button type="submit" class="btn btn-primary w-full accent-gradient border-none mt-2">Unlock &
            Download</button>
        </form>
        <div id="unlock-error" class="text-error text-sm mt-2"></div>
      </div>
    </div>
  </dialog>

  <script src="js/gleam-string-utils.js"></script>
  <script src="js/api.js"></script>
  <script src="js/user-auth.js"></script>
  <script src="js/player.js"></script>
  <script src="js/app.js"></script>
</body>

</html>