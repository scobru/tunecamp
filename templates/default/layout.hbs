<!DOCTYPE html>
<html lang="{{catalog.language}}" data-theme="dark">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{#if pageTitle}}{{pageTitle}} - {{/if}}{{catalog.title}}</title>
  {{#if catalog.description}}
  <meta name="description" content="{{catalog.description}}">
  {{/if}}
  <!-- Tunecamp Metadata (for community registry) -->
  <meta name="generator" content="Tunecamp 1.0.1">
  <meta name="tunecamp-title" content="{{catalog.title}}">
  {{#if artist}}
  <meta name="tunecamp-artist" content="{{artist.name}}">
  {{/if}}
  <!-- RSS/Atom Feeds -->
  <link rel="alternate" type="application/rss+xml" title="{{catalog.title}} RSS Feed" href="{{assetPath 'feed.xml'}}">
  <link rel="alternate" type="application/atom+xml" title="{{catalog.title}} Atom Feed" href="{{assetPath 'atom.xml'}}">
  {{#if catalog.customFontUrl}}
  <link rel="stylesheet" href="{{catalog.customFontUrl}}">
  {{/if}}
  <link rel="stylesheet" href="{{assetPath "assets/style.css"}}">
  {{#if catalog.customFontFamily}}
  <style>
    :root {
      --custom-font-family: '{{catalog.customFontFamily}}', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
    }
    body {
      font-family: var(--custom-font-family);
    }
  </style>
  {{/if}}
  {{#if catalog.customCSSUrl}}
  {{#if (or (startsWith catalog.customCSSUrl "http://") (startsWith catalog.customCSSUrl "https://"))}}
  <link rel="stylesheet" href="{{catalog.customCSSUrl}}">
  {{else}}
  <link rel="stylesheet" href="{{path catalog.customCSSUrl}}">
  {{/if}}
  {{/if}}
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  {{#if catalog.backgroundImageUrl}}
  <style>
    body {
      background-image: url('{{path catalog.backgroundImageUrl}}');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      background-repeat: no-repeat;
    }
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--bg-color);
      opacity: 0.85;
      z-index: -1;
    }
  </style>
  {{/if}}
  <script>
    // Initialize theme from localStorage or system preference
    (function () {
      const saved = localStorage.getItem('theme');
      if (saved) {
        document.documentElement.setAttribute('data-theme', saved);
      } else if (window.matchMedia('(prefers-color-scheme: light)').matches) {
        document.documentElement.setAttribute('data-theme', 'light');
      }
    })();
  </script>
</head>

<body>
  <!-- Top Navigation Bar - Faircamp style -->
  <nav class="top-nav">
    <a href="{{#if backUrl}}{{path backUrl}}{{else}}{{path "index.html"}}{{/if}}" class="nav-logo">
      <svg class="logo-icon" viewBox="0 0 100 100" fill="none">
        <circle cx="50" cy="50" r="45" stroke="currentColor" stroke-width="4"/>
        <circle cx="50" cy="50" r="20" fill="currentColor"/>
        <circle cx="50" cy="50" r="8" fill="var(--bg-color)"/>
      </svg>
      <span>{{#if artist}}{{artist.name}}{{else}}{{catalog.title}}{{/if}}</span>
    </a>
    <div class="nav-links">
      <a href="{{path "index.html"}}" class="nav-link">Browse</a>
    </div>
  </nav>

  <!-- Header with Background Image -->
  <header class="site-header">
    {{#if catalog.headerImageUrl}}
    <div class="header-background" style="background-image: url('{{path catalog.headerImageUrl}}');"></div>
    {{else}}
    <div class="header-background"></div>
    {{/if}}
    <div class="header-content">
      {{#if catalog.headerImageUrl}}
      <div class="header-image-display">
        <a href="{{path "index.html"}}">
          <img src="{{path catalog.headerImageUrl}}" alt="{{catalog.title}}" class="header-image">
        </a>
      </div>
      {{/if}}
    </div>
  </header>

  <main class="site-main">
    {{{content}}}
  </main>

  <footer class="site-footer">
    <div class="footer-content">
      <p>
        {{#if artist}}
        &copy; {{artist.name}} -
        {{/if}}
        Powered by <a href="https://github.com/scobru/tunecamp" target="_blank">Tunecamp</a>
      </p>
      {{#if artist.links}}
      <div class="social-links">
        {{#each artist.links}}
        {{#each this}}
        <a href="{{this}}" target="_blank" rel="noopener" class="social-link">
          <i class="fab fa-{{@key}}"></i>
        </a>
        {{/each}}
        {{/each}}
      </div>
      {{/if}}
    </div>
  </footer>

  <script src="{{assetPath "assets/player.js"}}"></script>

  <!-- Interactive Theme Widget -->
  <script src="{{assetPath "assets/theme-widget.js"}}"></script>

  <!-- Tunecamp Community Registry (auto-registers site) -->
  <script src="https://cdn.jsdelivr.net/npm/gun/gun.js"></script>
  <script src="{{assetPath "assets/community-registry.js"}}"></script>
</body>

</html>